language: python
python:
  - "2.6"
  - "2.7"

before_install:
  - deactivate
  - sudo rm -rf ~/virtualenv/python$TRAVIS_PYTHON_VERSION
  - echo 'yes' | sudo apt-add-repository ppa:tycho-s/ppa
  - sudo apt-get -qq update
  - sudo apt-get -qq install python-gtk2 python-xcbgen python-xlib xserver-xephyr qtile
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - sleep 3 # give xvfb some time to start
  - xauth generate $DISPLAY . trusted
  - randomkey=`echo $(($RANDOM * $RANDOM * 2)) | md5sum | cut -f1 -d" "`
  - xauth add $HOSTNAME$DISPLAY . $randomkey
  - virtualenv --system-site-packages --distribute --python=python$TRAVIS_PYTHON_VERSION ~/virtualenv/python$TRAVIS_PYTHON_VERSION
  - source ~/virtualenv/python$TRAVIS_PYTHON_VERSION/bin/activate

install:
  - python setup.py -q install

script: cd test; nosetests